/* comm.js @ https://www.github.com/jas-/comm.js */
(function(a){a.fn.comm=function(h){var g={appID:"comm.js",url:"",debug:false,element:a(this),async:false,method:"get",logID:"",callback:function(){},precallback:function(){},errcallback:function(){}};var b=b||{init:function(j){var i=f.merge(j,g);if(!f.init(i)){return false}return true}};var f=f||{merge:function(j,i){i.logID=i.appID;return a.extend({},i,j)},go:function(i){if(c.online()){c.decide(i,i.url)}else{return'{error:"Network connectivity not present"}'}return i.data},bind:function(k,j){var i=false;if((j).is("form")){(k.debug)?e.debug(k.logID,"_setup.bind: Currently bound to form"):false;a(j).on("submit",function(l){l.preventDefault();i=d.form(k,j);k.data=i;k.url=k.element[0]["action"];k.method=k.element[0]["method"];f.go(k)})}else{((k.debug)&&(i))?e.debug(k.logID,"_setup.bind: User supplied data specified"):false;f.go(k)}return i},init:function(i){e.init();return f.bind(i,i.element)}};var c=c||{online:function(){return navigator.onLine},retry:function(l,k,n){var i=10,j=0;var m=setInterval(function(q,p,r){(this.online)?this.decide(q,p,r):false},3600);clearInterval(m);return true},decide:function(i,j){if((/msie/i.test(navigator.userAgent))&&(/^(http|https):\/\//i.test(i.url))){return(this.online)?this.xdr(i,i.data,j):this.retry(i,i.data,j)}if(/^(ws|wss):\/\//i.test(i.url)){return(this.online)?this.websocket(i,i.data,j):this.retry(i,i.data,j)}if(/^(http|https):\/\//i.test(i.url)){i.async=true}return(this.online)?this.ajax(i,i.data,j):this.retry(i,i.data,j)},websocket:function(n,m,p){var l=false;try{var i;var k=n.url+"?cmd="+p;var i=new WebSocket(k);(n.debug)?e.debug(n.logID,"_comm.websocket: Status: "+i.readyState):false;i.onopen=function(){try{i.send(m);(n.debug)?e.debug(n.logID,"_comm.websocket: Sent: "+m):false}catch(o){e.error(n.logID,"_comm.websocket: Error => "+o)}};i.onmessage=function(o){(n.debug)?e.debug(n.logID,"_comm.websocket: Receieved: "+o.data):false;l=o.data};i.onclose=function(){(n.debug)?e.debug(n.logID,"_comm.websocket: Status: "+i.readyState):false}}catch(j){e.error(n.logID,"_comm.websocket: Error => "+j)}i.close();return l},xdr:function(l,k,m){var j=false;if(!window.XDomainRequest){e.error(l.logID,"_comm.xdr: Error => The XDR functionality for your browser was not found.");return false}var i=new XDomainRequest();i.timeout=100;i.open("post",l.url+"?cmd="+m);i.onsuccess=function(n){(l.debug)?e.debug(l.logID,"_libs.xdr: "+i.responseText):false;j=i.responseText};i.onerror=function(n){e.error(l.logID,"_libs.xdr: Error => "+n)};i.send(k);return j},ajax:function(l,k,m){var j=false,i=false;a.ajax({global:false,url:l.url,type:l.method,data:d.serialize(k),async:l.async,xhrFields:{withCredentials:true},beforeSend:function(n){i=(d.serialize(k))?d.base64(l,d.md5(l,d.serialize(k))):d.base64(l,d.md5(l,l.appID));(l.async)?n.setRequestHeader("X-Requested-With","XMLHttpRequest"):false;n.setRequestHeader("X-Alt-Referer",l.appID);n.setRequestHeader("Content-MD5",i);n.withCredentials=true;((l.precallback)&&(a.isFunction(l.precallback)))?l.precallback(a(this)):false;(l.debug)?e.debug(l.logID,'_comm.ajax: Set request headers => {"X-Alt-Referer":"'+l.appID+'","Content-MD5":"'+i+'"}'):false},success:function(n,o,p){l.appID=(/^[a-f0-9]{8}\-([a-f0-9]{4}\-){3}[a-f0-9]{12}$/i.test(p.getResponseHeader("X-Alt-Referer")))?p.getResponseHeader("X-Alt-Referer"):l.appID;(l.debug)?e.debug(l.logID,"_comm.ajax: "+o+" => "+p.statusText):false;((l.callback)&&(a.isFunction(l.callback)))?l.callback.call(n):false;j=n},error:function(p,n,o){e.error(l.appID,"_comm.ajax: "+n+" => "+o.message);((l.errcallback)&&(a.isFunction(l.errcallback)))?l.errcallback.call(p):false}});return j}};var d=d||{inspect:function(j,i){a.each(i,function(k,l){if((/object|array/.test(typeof(l)))&&(d.size(l)>0)){(j.debug)?e.debug(j.logID,"_libs.inspect: Examining "+k+" ("+typeof(l)+")"):false;d.inspect(j,l)}else{(j.debug)?e.debug(j.logID,"_libs.inspect: "+k+" => "+l):false}})},size:function(i){var j=0;if(/object/.test(typeof(i))){a.each(i,function(m,l){if(i.hasOwnProperty(m)){j++}})}else{if(/array/.test(typeof(i))){j=i.length}}return j},form:function(k,i){(k.debug)?e.debug(k.logID,"_libs.form: Retrieving form data"):false;var j={};a.each(i,function(m,l){a.each(l,function(o,n){if((n.name)&&(n.value)){j[n.name]=(/checkbox|radio/.test(n.type))?d.selected(k,n):n.value}})});(k.debug)?d.inspect(k,j):false;return(/object/.test(typeof(j)))?JSON.stringify(j):j},selected:function(j,i){return a("#"+i.name+":checked").map(function(){return this.value}).get()},serialize:function(j){if(d.size(j)>0){var i="";a.each(j,function(l,k){if(/object/.test(typeof(k))){d.serialize(k)}else{i+=l+"="+k+"&"}});i=i.substring(0,i.length-1)}else{i=j}return i},guid:function(p){var n="0123456789abcdef".split("");var l=[],k=Math.random,m;l[8]=l[13]=l[18]=l[23]="-";l[14]="4";for(var j=0;j<36;j++){if(!l[j]){m=0|k()*16;l[j]=n[(j==19)?(m&3)|8:m&15]}}return l.join("")},utf8:function(k,i){i=i.replace(/\r\n/g,"\n");var j="";for(var m=0;m<i.length;m++){var l=i.charCodeAt(m);if(l<128){j+=String.fromCharCode(l)}else{if((l>127)&&(l<2048)){j+=String.fromCharCode((l>>6)|192);j+=String.fromCharCode((l&63)|128)}else{j+=String.fromCharCode((l>>12)|224);j+=String.fromCharCode(((l>>6)&63)|128);j+=String.fromCharCode((l&63)|128)}}}return j},base64:function(l,z){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var t,p,m,y,x,w,u;var q=0;var j="";v=d.utf8(l,z);while(q<v.length){t=v.charCodeAt(q++);p=v.charCodeAt(q++);m=v.charCodeAt(q++);y=t>>2;x=((t&3)<<4)|(p>>4);w=((p&15)<<2)|(m>>6);u=m&63;if(isNaN(p)){w=u=64}else{if(isNaN(m)){u=64}}j=j+n.charAt(y)+n.charAt(x)+n.charAt(w)+n.charAt(u)}return j},md5:function(Q,P){function S(s,o){var k=(s<<o)|(s>>>(32-o));return k}function R(G,o){var I,k,F,H,x,s;F=(G&2147483648);H=(o&2147483648);I=(G&1073741824);k=(o&1073741824);x=(G&1073741823)+(o&1073741823);if(I&k){s=(x^2147483648^F^H)}if(I|k){if(x&1073741824){s=(x^3221225472^F^H)}else{s=(x^1073741824^F^H)}}else{s=(x^F^H)}return s}function z(k,s,o){return(k&s)|((~k)&o)}function y(k,s,o){return(k&o)|(s&(~o))}function w(k,s,o){return(k^s^o)}function t(k,s,o){return(s^(k|(~o)))}function B(F,o,ag,I,k,G,H){F=R(F,R(R(z(o,ag,I),k),H));return R(S(F,G),o)}function j(F,o,ag,I,k,G,H){F=R(F,R(R(y(o,ag,I),k),H));return R(S(F,G),o)}function N(F,o,ag,I,k,G,H){F=R(F,R(R(w(o,ag,I),k),H));return R(S(F,G),o)}function A(F,o,ag,I,k,G,H){F=R(F,R(R(t(o,ag,I),k),H));return R(S(F,G),o)}function i(F){var I;var x=F.length;var s=x+8;var o=(s-(s%64))/64;var H=(o+1)*16;var ag=Array(H-1);var k=0;var G=0;while(G<x){I=(G-(G%4))/4;k=(G%4)*8;ag[I]=(ag[I]|(F.charCodeAt(G)<<k));G++}I=(G-(G%4))/4;k=(G%4)*8;ag[I]=ag[I]|(128<<k);ag[H-2]=x<<3;ag[H-1]=x>>>29;return ag}function L(s){var o="",x="",F,k;for(k=0;k<=3;k++){F=(s>>>(k*8))&255;x="0"+F.toString(16);o=o+x.substr(x.length-2,2)}return o}var M=Array();var W,m,O,C,l,af,ae,ad,ac;var Z=7,X=12,U=17,T=22;var K=5,J=9,E=14,D=20;var u=4,r=11,q=16,p=23;var ab=6,aa=10,Y=15,V=21;string=d.utf8(Q,P);M=i(string);af=1732584193;ae=4023233417;ad=2562383102;ac=271733878;for(W=0;W<M.length;W+=16){m=af;O=ae;C=ad;l=ac;af=B(af,ae,ad,ac,M[W+0],Z,3614090360);ac=B(ac,af,ae,ad,M[W+1],X,3905402710);ad=B(ad,ac,af,ae,M[W+2],U,606105819);ae=B(ae,ad,ac,af,M[W+3],T,3250441966);af=B(af,ae,ad,ac,M[W+4],Z,4118548399);ac=B(ac,af,ae,ad,M[W+5],X,1200080426);ad=B(ad,ac,af,ae,M[W+6],U,2821735955);ae=B(ae,ad,ac,af,M[W+7],T,4249261313);af=B(af,ae,ad,ac,M[W+8],Z,1770035416);ac=B(ac,af,ae,ad,M[W+9],X,2336552879);ad=B(ad,ac,af,ae,M[W+10],U,4294925233);ae=B(ae,ad,ac,af,M[W+11],T,2304563134);af=B(af,ae,ad,ac,M[W+12],Z,1804603682);ac=B(ac,af,ae,ad,M[W+13],X,4254626195);ad=B(ad,ac,af,ae,M[W+14],U,2792965006);ae=B(ae,ad,ac,af,M[W+15],T,1236535329);af=j(af,ae,ad,ac,M[W+1],K,4129170786);ac=j(ac,af,ae,ad,M[W+6],J,3225465664);ad=j(ad,ac,af,ae,M[W+11],E,643717713);ae=j(ae,ad,ac,af,M[W+0],D,3921069994);af=j(af,ae,ad,ac,M[W+5],K,3593408605);ac=j(ac,af,ae,ad,M[W+10],J,38016083);ad=j(ad,ac,af,ae,M[W+15],E,3634488961);ae=j(ae,ad,ac,af,M[W+4],D,3889429448);af=j(af,ae,ad,ac,M[W+9],K,568446438);ac=j(ac,af,ae,ad,M[W+14],J,3275163606);ad=j(ad,ac,af,ae,M[W+3],E,4107603335);ae=j(ae,ad,ac,af,M[W+8],D,1163531501);af=j(af,ae,ad,ac,M[W+13],K,2850285829);ac=j(ac,af,ae,ad,M[W+2],J,4243563512);ad=j(ad,ac,af,ae,M[W+7],E,1735328473);ae=j(ae,ad,ac,af,M[W+12],D,2368359562);af=N(af,ae,ad,ac,M[W+5],u,4294588738);ac=N(ac,af,ae,ad,M[W+8],r,2272392833);ad=N(ad,ac,af,ae,M[W+11],q,1839030562);ae=N(ae,ad,ac,af,M[W+14],p,4259657740);af=N(af,ae,ad,ac,M[W+1],u,2763975236);ac=N(ac,af,ae,ad,M[W+4],r,1272893353);ad=N(ad,ac,af,ae,M[W+7],q,4139469664);ae=N(ae,ad,ac,af,M[W+10],p,3200236656);af=N(af,ae,ad,ac,M[W+13],u,681279174);ac=N(ac,af,ae,ad,M[W+0],r,3936430074);ad=N(ad,ac,af,ae,M[W+3],q,3572445317);ae=N(ae,ad,ac,af,M[W+6],p,76029189);af=N(af,ae,ad,ac,M[W+9],u,3654602809);ac=N(ac,af,ae,ad,M[W+12],r,3873151461);ad=N(ad,ac,af,ae,M[W+15],q,530742520);ae=N(ae,ad,ac,af,M[W+2],p,3299628645);af=A(af,ae,ad,ac,M[W+0],ab,4096336452);ac=A(ac,af,ae,ad,M[W+7],aa,1126891415);ad=A(ad,ac,af,ae,M[W+14],Y,2878612391);ae=A(ae,ad,ac,af,M[W+5],V,4237533241);af=A(af,ae,ad,ac,M[W+12],ab,1700485571);ac=A(ac,af,ae,ad,M[W+3],aa,2399980690);ad=A(ad,ac,af,ae,M[W+10],Y,4293915773);ae=A(ae,ad,ac,af,M[W+1],V,2240044497);af=A(af,ae,ad,ac,M[W+8],ab,1873313359);ac=A(ac,af,ae,ad,M[W+15],aa,4264355552);ad=A(ad,ac,af,ae,M[W+6],Y,2734768916);ae=A(ae,ad,ac,af,M[W+13],V,1309151649);af=A(af,ae,ad,ac,M[W+4],ab,4149444226);ac=A(ac,af,ae,ad,M[W+11],aa,3174756917);ad=A(ad,ac,af,ae,M[W+2],Y,718787259);ae=A(ae,ad,ac,af,M[W+9],V,3951481745);af=R(af,m);ae=R(ae,O);ad=R(ad,C);ac=R(ac,l)}var n=L(af)+L(ae)+L(ad)+L(ac);return n.toLowerCase()}};var e=e||{init:function(){if(typeof(i)==="undefined"){var i={};i.log=i.error=i.info=i.debug=i.warn=function(){};return i}return false},debug:function(k,j){(typeof(console.debug)==="function")?console.debug("["+k+"] (DEBUG) "+j):e.spoof(k,"DEBUG",j);return true},info:function(k,j){(typeof(console.info)==="function")?console.info("["+k+"] (INFO) "+j):e.spoof(k,"INFO",j);return true},warn:function(k,j){(typeof(console.warn)==="function")?console.warn("["+k+"] (WARN) "+j):e.spoof(k,"WARN",j);return true},error:function(k,j){console=this.init();(typeof(console.error)==="function")?console.error("["+k+"] (ERROR) "+j):e.spoof(k,"ERROR",j);return true},spoof:function(m,j,k){window.log=function(p,n,o){return this.log("["+p+"] ("+n+") "+o)}}};if(b[h]){return b[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof h==="object")||(!h)){return b.init.apply(this,arguments)}else{e.error("Method "+h+" does not exist")}}return true}})(jQuery);